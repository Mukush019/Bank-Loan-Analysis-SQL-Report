SELECT * FROM financial_loan;
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total number of loan applications

SELECT 
	COUNT(id) AS `Total loan applications`
FROM financial_loan;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- update the issue_date column from text to date

UPDATE financial_loan
SET `Issue Date` = STR_TO_DATE (`Issue Date`, '%d/%m/%Y');

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- MTD Total loan Applications

SELECT 
	COUNT(Id) AS `MTD Total loan applications`
FROM financial_loan
	WHERE MONTH(`Issue Date`) = 12;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- PMTD Total loan applications

SELECT 
	COUNT(id) AS PMTD_Total_loan_applications
FROM financial_loan
	WHERE MONTH(`Issue Date`) = 11;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Loan Disbursed

SELECT SUM(`Total Loan Disbursed`) `Total Loan Disbursed`
FROM financial_loan;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 -- MTD Total Loan Disbursed

SELECT 
	ROUND(SUM(`Total Loan Disbursed`)/1000000, 3) `MTD Total Loan Disbursed`
FROM financial_loan
	WHERE MONTH(`Issue Date`) = 12;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- PMTD Total Loan Disbursed

SELECT ROUND(SUM(`Total Loan Disbursed`)/1000000, 3) `MTD Total Loan Disbursed`
FROM financial_loan
WHERE MONTH(`Issue Date`) = 11;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Loan Amount Repaid

SELECT 
	ROUND(SUM(`Total Payment`)/1000000,3) `Total Repaid`
FROM financial_loan;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Average interest rate 

SELECT 
	ROUND(AVG(`Int Rate`),4)*100 "Average Interest Rate"
FROM financial_loan;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- MTD Average interest rate

SELECT 
	ROUND(AVG(`Int Rate`),4)*100 "Average Interest Rate"
FROM financial_loan
WHERE MONTH(`Issue Date`) = 12;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- PMTD Average interest rate

SELECT 
	ROUND(AVG(`Int Rate`),4)*100 "Average Interest Rate"
FROM financial_loan
WHERE MONTH(`Issue Date`) = 11;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Average DTI

SELECT 
	ROUND(AVG(Dti),4)*100 "Average DTI"
FROM financial_loan;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- MTD Average DTI

SELECT 
	ROUND(AVG(Dti),4)*100 "Average DTI"
FROM financial_loan
	WHERE MONTH(`Issue Date`) = 12;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- PMTD Average DTI

SELECT 
	ROUND(AVG(Dti),4)*100 "Average DTI"
FROM financial_loan
	WHERE MONTH(`Issue Date`) = 11;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Good Loan Percent

SELECT 
	COUNT(	
		CASE 
			WHEN 
				(`Loan Status` = 'Fully Paid'
				 OR
				`Loan Status` = 'Current')
			THEN id END)*100
			/
	COUNT(
		id
		 ) AS "Percentage of Good Loans"
FROM financial_loan;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Good Loan Applications

SELECT 
	COUNT(	
		CASE 
			WHEN 
				(`Loan Status` = 'Fully Paid'
				 OR
				`Loan Status` = 'Current')
			THEN id END)
	 AS "Total Good Loan Applications"
FROM financial_loan;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Good Loan Disbursed

SELECT 
	SUM(`Loan Amount`) AS "Total Good Loan Disbursed" 
FROM financial_loan
WHERE `Loan Status` = 'Fully Paid'
	OR
	  `Loan Status` = 'Current';

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Good Loan paid

SELECT 
	SUM(`Total Payment`) AS "Total Good Loan Repaid" 
FROM financial_loan
WHERE `Loan Status` = 'Fully Paid'
	OR
	  `Loan Status` = 'Current';

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Percentage of Bad Loans

SELECT 
	COUNT(	
		CASE 
			WHEN 
				(`Loan Status` = 'Charged Off'
				)
			THEN id END)*100
			/
	COUNT(
		id
		 ) "Percentage of Bad Loans"
FROM financial_loan;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Bad Loan Applications

SELECT 
	COUNT(	
		CASE 
			WHEN 
				(`Loan Status` = 'Charged Off'
				 )
			THEN id END)
	 "Bad Loan Applications"
FROM financial_loan;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Bad Loan Disbursed

SELECT 
	SUM(`Loan Amount`) "Total Bad Loan Disbursed" 
FROM financial_loan
	WHERE `Loan Status` = 'Charged Off';

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Bad Loan paid

SELECT 
	SUM(`Total Payment`) "Total Bad Loan Repaid" 
FROM financial_loan
	WHERE `Loan Status` = 'Charged Off';

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Loan status grid view

SELECT 
	`Loan Status`,
	COUNT(`Id`) "Total loan Application",
	SUM(`Loan Amount`) "Total Loan Disbursed",
	ROUND(AVG(`Int Rate`*100),4) AS "Average Interest Rate",
	ROUND(AVG(`DTI`*100),4) AS "Average dti"
FROM financial_loan F
	GROUP BY `Loan Status`;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- MTD Loan status grid view

SELECT 
	`Loan Status`,
	COUNT(Id) AS "MTD Total loan Application",
	SUM(`Loan Amount`) "MTD Total Loan Disbursed",
	ROUND(AVG(`Int Rate`*100),4) "MTD Average Interest Rate",
	ROUND(AVG(DTI*100),4) "MTD Average dti"
FROM financial_loan
	WHERE MONTH(`Issue Date`) = 12
	GROUP BY `Loan Status`;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- PMTD Loan status grid view

SELECT
`Loan Status`,
	COUNT(Id) AS "PMTD Total loan Application",
	SUM(`Loan Amount`) "PMTD Total Loan Disbursed",
	ROUND(AVG(`Int Rate`*100),4) "PMTD Average Interest Rate",
	ROUND(AVG(DTI*100),4) "PMTD Average dti"
FROM financial_loan
	WHERE MONTH(`Issue Date`) = 11
	GROUP BY `Loan Status`;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Monthly loan issued

SELECT 
	MONTH(B.issue_date) "Month Number",
	DATENAME(MONTH, B.issue_date) AS "Month of Loan issue",
	COUNT(B.id) AS "Total loan Application",
	SUM (B.loan_amount) AS "Total Loan Disbursed"
FROM Bank_loan_data B
GROUP BY MONTH(B.issue_date), DATENAME(MONTH, B.issue_date)
ORDER BY MONTH(B.issue_date);

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Regional Analysis by state
SELECT 
	B.address_state,
	COUNT(B.id) AS "Total loan Application",
	SUM (B.loan_amount) AS "Total Loan Disbursed"
FROM Bank_loan_data B
GROUP BY B.address_state
ORDER BY SUM (B.loan_amount) DESC;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Applications by Term

SELECT 
	B.term,
	COUNT(B.id) AS "Total loan Application",
	SUM (B.loan_amount) AS "Total Loan Disbursed"
FROM Bank_loan_data B
GROUP BY B.term
ORDER BY SUM (B.loan_amount) DESC;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Applications by Employee Length

SELECT 
	B.emp_length,
	COUNT(B.id) AS "Total loan Application",
	SUM (B.loan_amount) AS "Total Loan Disbursed"
FROM Bank_loan_data B
GROUP BY B.emp_length
ORDER BY SUM (B.loan_amount) DESC;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Applications by Purpose

SELECT 
	B.purpose,
	COUNT(B.id) AS "Total loan Application",
	SUM (B.loan_amount) AS "Total Loan Disbursed"
FROM Bank_loan_data B
	GROUP BY B.purpose
	ORDER BY SUM (B.loan_amount) DESC;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Total Applications by home ownership

SELECT 
	B.home_ownership,
	COUNT(B.id) AS "Total loan Application",
	SUM (B.loan_amount) AS "Total Loan Disbursed"
FROM Bank_loan_data B
	GROUP BY B.home_ownership
	ORDER BY SUM (B.loan_amount) DESC;
